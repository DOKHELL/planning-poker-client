import{d as h,c as d,j as e,a as _,e as P,i as V,B,F as y,f as w,r as S,g as N,h as v,k as W,s as f,l as k,m as z,n as $,o as F,p as j,G as A,q as M,t as X,P as D}from"./index.a6fdb8fb.js";const E="_gamePlayer_12sff_2",O="_observer_12sff_7",q="_gamePlayerImg_12sff_7",H="_showResult_12sff_24",J="_active_12sff_24",K="_gamePlayerPhoto_12sff_53",Q="_gamePlayerWrapper_12sff_67",Y="_gamePlayerName_12sff_102",l={gamePlayer:E,observer:O,gamePlayerImg:q,showResult:H,active:J,gamePlayerPhoto:K,gamePlayerWrapper:Q,gamePlayerName:Y},C=({user:t})=>{const{showResult:a}=h(),c=d(l.gamePlayer,t.observer?l.observer:"",t.card?l.active:"",a?l.showResult:"");return e("div",{className:c,children:_("div",{className:l.gamePlayerWrapper,children:[_("div",{className:l.gamePlayerImg,children:[t.photo?e("img",{className:l.gamePlayerPhoto,src:t.photo,alt:"photo"}):"",a&&t.card?e("span",{children:t.card}):""]}),e("div",{className:l.gamePlayerName,children:t.username})]})})},Z=()=>{const{id:t}=P(),{showResult:a}=h(),c=()=>{w(t)};return V()&&!a?e(B,{text:"Reveal cards",onClick:c}):a?e(B,{text:"Start new voting",onClick:c}):e(y,{children:"Pick your cards!"})},U="_gameTable_rmbz6_1",aa="_gameTableSide_rmbz6_25",ea="_gameTableTop_rmbz6_32",ta="_gameTableLeft_rmbz6_45",sa="_gameTableCenter_rmbz6_56",ca="_gameTableRight_rmbz6_80",ia="_gameTableBottom_rmbz6_90",n={gameTable:U,gameTableSide:aa,gameTableTop:ea,gameTableLeft:ta,gameTableCenter:sa,gameTableRight:ca,gameTableBottom:ia},oa=()=>{const{users:t=[]}=h(),a=(t==null?void 0:t.filter(R=>R.active))||[],c=0,o=Math.ceil((a==null?void 0:a.length)*.3),i=o,r=o+o,u=r,s=Math.ceil(((a==null?void 0:a.length)-(r+1))/2)+r,g=s,b=(a==null?void 0:a.length)-s+s,T=a==null?void 0:a.slice(c,o),x=a==null?void 0:a.slice(i,r),G=a==null?void 0:a.slice(u,s),I=a==null?void 0:a.slice(g,b);return{filterUsers:a,bottomUsers:T,topUsers:x,leftUsers:G,rightUsers:I}},na=()=>{const{bottomUsers:t,topUsers:a,leftUsers:c,rightUsers:o}=oa();return _("div",{className:n.gameTable,children:[e("div",{}),e("div",{className:d(n.gameTableTop,n.gameTableSide),children:a==null?void 0:a.map(i=>e(C,{user:i},i.userId))}),e("div",{}),e("div",{className:d(n.gameTableLeft,n.gameTableSide),children:c==null?void 0:c.map(i=>e(C,{user:i},i.userId))}),e("div",{className:d(n.gameTableCenter,n.gameTableSide),children:e(Z,{})}),e("div",{className:d(n.gameTableRight,n.gameTableSide),children:o==null?void 0:o.map(i=>e(C,{user:i},i.userId))}),e("div",{}),e("div",{className:d(n.gameTableBottom,n.gameTableSide),children:t==null?void 0:t.map(i=>e(C,{user:i},i.userId))}),e("div",{})]})},ma="_gameStatistic_1k3ub_1",ra="_gameStatisticList_1k3ub_10",la="_gameStatisticItem_1k3ub_19",ga="_gameStatisticBarContainer_1k3ub_25",da="_gameStatisticBar_1k3ub_25",_a="_gameStatisticBarFill_1k3ub_40",ua="_gameStatisticCardContainer_1k3ub_49",ha="_gameStatisticCardSpacer_1k3ub_56",Sa="_gameStatisticValue_1k3ub_60",ba="_gameStatisticCardSpacerXL_1k3ub_74",Ca="_gameStatisticVotes_1k3ub_78",pa="_mostVoted_1k3ub_83",m={gameStatistic:ma,gameStatisticList:ra,gameStatisticItem:la,gameStatisticBarContainer:ga,gameStatisticBar:da,gameStatisticBarFill:_a,gameStatisticCardContainer:ua,gameStatisticCardSpacer:ha,gameStatisticValue:Sa,gameStatisticCardSpacerXl:ba,gameStatisticVotes:Ca,mostVoted:pa},va=()=>{var u;const{users:t=[]}=h(),a=(u=t==null?void 0:t.map(s=>s.card))==null?void 0:u.filter(s=>Number(s)),c=(a==null?void 0:a.reduce((s,g)=>(s[g]=(s[g]||0)+1,s),{}))||{},o=Math.max(...Object.values(c))||0,i=Object.keys(c),r=s=>c[s]*100/o;return e("div",{className:m.gameStatistic,children:e("ul",{className:m.gameStatisticList,children:i.map(s=>e("li",{className:r(s)===100?m.mostVoted:"",children:_("div",{className:m.gameStatisticItem,children:[e("div",{className:m.gameStatisticBarContainer,children:e("div",{className:m.gameStatisticBar,children:e("div",{className:m.gameStatisticBarFill,style:{height:`${r(s)}%`}})})}),_("div",{className:m.gameStatisticCardContainer,children:[e("div",{className:m.gameStatisticCardSpacer}),e("div",{className:m.gameStatisticValue,children:s}),_("div",{className:m.gameStatisticVotes,children:[c[s]," ",c[s]<2?"Vote":"Votes"]})]})]})},s))})})},Ta=S.exports.memo(va),Pa="_gameCardsList_1uc87_1",ya="_active_1uc87_14",Na="_gameCardsButton_1uc87_14",Ba="_gameCardsCard_1uc87_22",p={gameCardsList:Pa,active:ya,gameCardsButton:Na,gameCardsCard:Ba},fa=()=>{const{id:t}=P(),[a]=N(v.auth),{users:c=[],userData:o}=h(),i=["1","2","3","5","8","13","21","34","55","89","?"],r=s=>{W(t,s,a==null?void 0:a.uid)},u=s=>{var b;return(((b=c.find(T=>T.userId===(a==null?void 0:a.uid)))==null?void 0:b.card)||"")===s?p.active:""};return e("div",{className:p.gameCardsList,children:o!=null&&o.observer?null:i.map((s,g)=>e("div",{className:p.gameCardsCard,onClick:()=>r(s),children:e("button",{className:d(p.gameCardsButton,u(s)),children:e("span",{children:s})})},g))})},ka=S.exports.memo(fa),La=()=>{const{showResult:t}=h();return e(y,{children:t?e(Ta,{}):e(ka,{})})},xa=S.exports.memo(La),Ga="_gamePage_znvlx_1",Ia="_gamePageTableWrapper_znvlx_7",L={gamePage:Ga,gamePageTableWrapper:Ia},Ra=()=>{const{id:t}=P(),[a]=N(v.auth),c=async()=>{const o=new A,{user:i}=await M(v.auth,o);i&&(f(i),k(t),X())};return S.exports.useEffect(()=>()=>{console.log("Disconnected"),j("leave")},[]),S.exports.useEffect(()=>{a?(f(a),k(t),z(t,a)):($(t),F({variant:"success",title:"Please first login to play",canClose:!1,maxWidth:740,onConfirm:c,confirmBtnText:"Login By Google"}))},[a]),_(y,{children:[e("div",{className:L.gamePageTableWrapper,children:e(na,{})}),e(xa,{})]})},wa=()=>{const[,t]=N(v.auth);return t?e(D,{}):e("div",{className:L.gamePage,children:e(Ra,{})})};export{wa as default};
